"use strict";(self.webpackChunkdocusaurus_files=self.webpackChunkdocusaurus_files||[]).push([[140],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>f});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),h=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=h(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=h(n),d=i,f=c["".concat(l,".").concat(d)]||c[d]||p[d]||r;return n?a.createElement(f,o(o({ref:t},u),{},{components:n})):a.createElement(f,o({ref:t},u))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:i,o[1]=s;for(var h=2;h<r;h++)o[h]=n[h];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6325:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>h});var a=n(7462),i=(n(7294),n(3905));const r={},o="2021-11-4",s={unversionedId:"CTFs/2021-11-4",id:"CTFs/2021-11-4",title:"2021-11-4",description:"CyberPatriot (c) Windows Server 19 Image file Forensic questions",source:"@site/docs/CTFs/2021-11-4.md",sourceDirName:"CTFs",slug:"/CTFs/2021-11-4",permalink:"/cybersecurity-information/CTFs/2021-11-4",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Anatomy of an Attack",permalink:"/cybersecurity-information/Anatomy of an Attack"},next:{title:"Email and Hacking",permalink:"/cybersecurity-information/Email and Hacking"}},l={},h=[{value:"Question 1:",id:"question-1",level:2},{value:"STEP #1",id:"step-1",level:3},{value:"STEP #2",id:"step-2",level:3},{value:"Answer",id:"answer",level:3},{value:"Question 2:",id:"question-2",level:2},{value:"STEP #1",id:"step-1-1",level:3},{value:"STEP #2",id:"step-2-1",level:3},{value:"Answer",id:"answer-1",level:3}],u={toc:h};function c(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"2021-11-4"},"2021-11-4"),(0,i.kt)("p",null,"CyberPatriot (c) Windows Server 19 Image file Forensic questions "),(0,i.kt)("p",null,"User Accounts:"),(0,i.kt)("p",null,"eleven (you)\npassword: niNApr0j3(t"),(0,i.kt)("p",null,"Forensic Question #1:"),(0,i.kt)("h2",{id:"question-1"},"Question 1:"),(0,i.kt)("p",null,"There is currently a backdoor running on this machine disguising itself as a Windows Service.\nWhat is the Service name of this malicious service?"),(0,i.kt)("p",null,"Answer Flow:"),(0,i.kt)("h3",{id:"step-1"},"STEP #1"),(0,i.kt)("p",null,"First, open Task manager by pressing CTRL + SHIFT + ESC.\nWe saw that the Task manager is disabled. So we need to enable it.\nTo enable it, we will open the registry editor and check if there has been a change.\nThe Path for the registry is "),(0,i.kt)("p",null,"Computer -> HKEY_CURRENT_USER -> Software -> Microsoft -> Windows -> CurrentVersion -> Policies -> System"),(0,i.kt)("p",null,"In this path, there should be a DWORD value named DisableTaskMgr. If it is not there, then we need to create it.\nIf it is there, and the value is being set to 1, we need to change it to 0.\nWhen the value is 0, means that is it false so the taskmanager is enabled."),(0,i.kt)("h3",{id:"step-2"},"STEP #2"),(0,i.kt)("p",null,"Since we now have the Task manager, we can now check for all the Tasks that are running on the system.\nTo identify the service which is malicious, we just scroll through all names and check if there are any suspicious names."),(0,i.kt)("p",null,"If you identified a suspicous name, you can go to ",(0,i.kt)("a",{parentName:"p",href:"https://www.processlibrary.com/en/"},"https://www.processlibrary.com/en/")," and search the the name."),(0,i.kt)("p",null,"If there are results, then you can see if the service is malicious or not. If there are no results, it is very likely that this is the service you are searching for."),(0,i.kt)("p",null,"To be sure that you're not doing something wrong, you can always google the service and check if there are any results.\nBy just doing basic research you can find out if the service is the one you are searching for."),(0,i.kt)("h3",{id:"answer"},"Answer"),(0,i.kt)("p",null,'In our case, it was the service named "windUM".'),(0,i.kt)("h2",{id:"question-2"},"Question 2:"),(0,i.kt)("p",null,'On the Desktop, there is a file named "hidden sercret.txt". This file contains a hidden message.'),(0,i.kt)("p",null,"Content of the file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"UUwEBRQAAAAIAFJnZFVhZeTRPwAAAEIAAAALAAAAbWVzc2FnZS50eHQNyNsNgCAMBdBV7gSO4g4VqjTpwxQfYXv4OsnZ44g64JFGCv44QaWE3Sq9cQX5eJr4BWPy5fkqxLGu44/Uuk1QSwECPwAUAAAACABSZ2RVYWXk0T8AAABCAAAACwAkAAAAAAAAACAAAAAAAAAAbWVzc2FnZS50eHQKACAAAAAAAAEAGABptmEPd/DYAWn9H3t38NgBspJWD3fw2AFQSwUGAAAAAAEAAQBdAAAAaAAAAAAA\n")),(0,i.kt)("p",null,"What is the message inside the file?"),(0,i.kt)("p",null,"We have 2 hints for you:\n",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/List_of_file_signatures"},"https://en.wikipedia.org/wiki/List_of_file_signatures"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://mh-nexus.de/en/hxd/"},"https://mh-nexus.de/en/hxd/")),(0,i.kt)("p",null,"Answer Flow:"),(0,i.kt)("p",null,"First, we need to indentify the type of code we have here."),(0,i.kt)("p",null,"For all of the steps, we will be using CyberChef (",(0,i.kt)("a",{parentName:"p",href:"https://gchq.github.io/CyberChef/"},"https://gchq.github.io/CyberChef/"),")"),(0,i.kt)("h3",{id:"step-1-1"},"STEP #1"),(0,i.kt)("p",null,'Paste the code into the input, and select the "magic" option.\nThe Magic operation attempts to detect various properties of the input data and suggests which operations could help to make more sense of it.'),(0,i.kt)("p",null,"On the output, we can see that the code is a Base64 string."),(0,i.kt)("p",null,'So now we remove the magic option from the input and select the "From Base64" option.\nWe also choose the "to hexdump" option, which will convert the output to hexdump.'),(0,i.kt)("p",null,"The result should be looking something like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"00000000  51 4c 04 05 14 00 00 00 08 00 52 67 64 55 61 65  |QL........RgdUae|\n00000010  e4 d1 3f 00 00 00 42 00 00 00 0b 00 00 00 6d 65  |\xe4\xd1?...B.......me|\n00000020  73 73 61 67 65 2e 74 78 74 0d c8 db 0d 80 20 0c  |ssage.txt.\xc8\xdb.. .|\n00000030  05 d0 55 ee 04 8e e2 0e 15 aa 34 e9 c3 14 1f 61  |.\xd0U\xee..\xe2..\xaa4\xe9\xc3..a|\n00000040  7b f8 3a c9 d9 e3 88 3a e0 91 46 0a fe 38 41 a5  |{\xf8:\xc9\xd9\xe3.:\xe0.F.\xfe8A\xa5|\n00000050  84 dd 2a bd 71 05 f9 78 9a f8 05 63 f2 e5 f9 2a  |.\xdd*\xbdq.\xf9x.\xf8.c\xf2\xe5\xf9*|\n00000060  c4 b1 ae e3 8f d4 ba 4d 50 4b 01 02 3f 00 14 00  |\xc4\xb1\xae\xe3.\xd4\xbaMPK..?...|\n00000070  00 00 08 00 52 67 64 55 61 65 e4 d1 3f 00 00 00  |....RgdUae\xe4\xd1?...|\n00000080  42 00 00 00 0b 00 24 00 00 00 00 00 00 00 20 00  |B.....$....... .|\n00000090  00 00 00 00 00 00 6d 65 73 73 61 67 65 2e 74 78  |......message.tx|\n000000a0  74 0a 00 20 00 00 00 00 00 01 00 18 00 69 b6 61  |t.. .........i\xb6a|\n000000b0  0f 77 f0 d8 01 69 fd 1f 7b 77 f0 d8 01 b2 92 56  |.w\xf0\xd8.i\xfd.{w\xf0\xd8.\xb2.V|\n000000c0  0f 77 f0 d8 01 50 4b 05 06 00 00 00 00 01 00 01  |.w\xf0\xd8.PK.........|\n000000d0  00 5d 00 00 00 68 00 00 00 00 00                 |.]...h.....|\n")),(0,i.kt)("p",null,"We can already see that there is a PK in the hexdump, which means that it is a zip file."),(0,i.kt)("h3",{id:"step-2-1"},"STEP #2"),(0,i.kt)("p",null,"We now know that the code is a zip file, and we know that it is supposed to have the PK header.\nWe refer to one of the hints, which is the list of file signatures.\nWe search for PK in the list of headers, and we find the hex signature is 50 4B 03 04."),(0,i.kt)("p",null,"Now in our hexdump, we can see that the signature is not 50 4B 03 04, it is 51 4c 04 05."),(0,i.kt)("p",null,"Lets compare them:"),(0,i.kt)("p",null,"50 4B 03 04\n51 4C 04 05"),(0,i.kt)("p",null,"We can already see that the bytes are all 1 bit off, so we correct them."),(0,i.kt)("p",null,"we replace ",(0,i.kt)("inlineCode",{parentName:"p"},"51")," with ",(0,i.kt)("inlineCode",{parentName:"p"},"50"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"4C")," with ",(0,i.kt)("inlineCode",{parentName:"p"},"4B"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"04")," with ",(0,i.kt)("inlineCode",{parentName:"p"},"03"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"05")," with ",(0,i.kt)("inlineCode",{parentName:"p"},"04"),"."),(0,i.kt)("p",null,"Now, we have should have a working zip file, lets try to unzip it."),(0,i.kt)("p",null,"The corrected zip file should look like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"00000000  50 4B 03 04 14 00 00 00 08 00 52 67 64 55 61 65  |QL........RgdUae|\n00000010  e4 d1 3f 00 00 00 42 00 00 00 0b 00 00 00 6d 65  |\xe4\xd1?...B.......me|\n00000020  73 73 61 67 65 2e 74 78 74 0d c8 db 0d 80 20 0c  |ssage.txt.\xc8\xdb.. .|\n00000030  05 d0 55 ee 04 8e e2 0e 15 aa 34 e9 c3 14 1f 61  |.\xd0U\xee..\xe2..\xaa4\xe9\xc3..a|\n00000040  7b f8 3a c9 d9 e3 88 3a e0 91 46 0a fe 38 41 a5  |{\xf8:\xc9\xd9\xe3.:\xe0.F.\xfe8A\xa5|\n00000050  84 dd 2a bd 71 05 f9 78 9a f8 05 63 f2 e5 f9 2a  |.\xdd*\xbdq.\xf9x.\xf8.c\xf2\xe5\xf9*|\n00000060  c4 b1 ae e3 8f d4 ba 4d 50 4b 01 02 3f 00 14 00  |\xc4\xb1\xae\xe3.\xd4\xbaMPK..?...|\n00000070  00 00 08 00 52 67 64 55 61 65 e4 d1 3f 00 00 00  |....RgdUae\xe4\xd1?...|\n00000080  42 00 00 00 0b 00 24 00 00 00 00 00 00 00 20 00  |B.....$....... .|\n00000090  00 00 00 00 00 00 6d 65 73 73 61 67 65 2e 74 78  |......message.tx|\n000000a0  74 0a 00 20 00 00 00 00 00 01 00 18 00 69 b6 61  |t.. .........i\xb6a|\n000000b0  0f 77 f0 d8 01 69 fd 1f 7b 77 f0 d8 01 b2 92 56  |.w\xf0\xd8.i\xfd.{w\xf0\xd8.\xb2.V|\n000000c0  0f 77 f0 d8 01 50 4b 05 06 00 00 00 00 01 00 01  |.w\xf0\xd8.PK.........|\n000000d0  00 5d 00 00 00 68 00 00 00 00 00                 |.]...h.....|\n")),(0,i.kt)("p",null,'We open a new instance of Cyber chef, and paste the corrected hexdump into the input.\nAs bakery, we choose the "From hexdump" option, and then "unzip".'),(0,i.kt)("p",null,"When done correctly, you should have a message.txt file as an output, and when you open it, you should see the flag."),(0,i.kt)("h3",{id:"answer-1"},"Answer"),(0,i.kt)("p",null,'In our case, the flag was "Nobody normal ever accomplished anything meaningful in this world."'))}c.isMDXComponent=!0}}]);